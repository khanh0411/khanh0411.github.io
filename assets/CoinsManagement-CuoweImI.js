import{r,e as v,c as w,k as u,l as _,F as S,ce as k,E as l,j as c,o as C,a as t,x as B,C as L}from"./index-3TT_0WAL.js";import{u as T}from"./studentCourse.store-DycZazWx.js";const j={class:"flex items-center justify-between flex-wrap gap-3.5 mb-3 mx-5"},F={class:"flex items-center justify-between flex-wrap gap-3.5"},I={class:"relative w-[250px]"},A={__name:"CoinsManagement",setup(G){const d=T(),n=r(!1),o=r(""),i=r({searchQuery:o.value}),p=r(new k({cols:[{title:"ID",key:"mapped_id",i18n:"",width:"10%",sortable:!1},{title:"Người yêu cầu",key:"full_name",i18n:"",width:"18%",sortable:!1},{title:"Ngày",key:"date",i18n:"",width:"18%",sortable:!1},{title:"Loại",key:"type2",i18n:"",width:"18%",sortable:!0},{title:"Trạng thái",key:"statuscoins",i18n:"",width:"18%",sortable:!0},{title:"Số Coin",key:"coins",i18n:"",width:"18%",sortable:!1}],rows:[],uniqueField:"mapped_id",isShowActionIconOnly:!0,showMoreButton:!1,editButton:!1,deleteButton:!1,height:800,pagination:{page:1,totals:5}}));async function f(){n.value=!0;const e=await d.handleGetRechargeHistory();n.value=!1,e.errors?l({text:e.errors,type:"error"}):p.value.rows=e.purchase_history}async function h(e){const s={purchase_id:e.id,status:e.statuscoins};n.value=!0;const a=await d.handleUpdateRechargeStatus(s);n.value=!1,a.errors?l({text:a.errors,type:"error"}):a.data.message==="completed"?l({text:`Đã nạp cho ${e.full_name} ${e.coins} coins`,type:"success"}):a.data.message==="cancelled"?l({text:`Đã hủy yêu cầu từ ${e.full_name} `,type:"warn"}):l({text:"Có lỗi xảy ra, vui lòng kiểm tra lại",type:"error"})}function y(){i.value.searchQuery=o.value}function m(){o.value="",i.value.searchQuery="",f()}return v(async()=>{f()}),(e,s)=>{const a=c("GenericTable"),g=c("AdminLayout"),b=c("FullScreenLoading");return C(),w(S,null,[u(g,null,{default:_(()=>[t("form",j,[t("div",F,[t("div",I,[B(t("input",{"onUpdate:modelValue":s[0]||(s[0]=x=>o.value=x),type:"text",class:"w-full h-10 pl-4 pr-12 border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-[#669ee9] focus:border-[#669ee9]",placeholder:"Search",onInput:y},null,544),[[L,o.value]]),s[1]||(s[1]=t("span",{class:"absolute right-0 top-0 h-full px-3 flex items-center text-[#669ee9] border-l border-gray-200"},[t("i",{class:"bi bi-search"})],-1))])]),t("div",{class:"flex items-center justify-between gap-3.5"},[t("button",{onClick:m,type:"button",class:"flex items-center justify-center w-[47px] h-10 text-[#669ee9] bg-white border border-gray-200 rounded hover:bg-[#669ee9] hover:text-white transition-colors duration-150"},s[2]||(s[2]=[t("i",{class:"bi bi-arrow-repeat"},null,-1)]))])]),u(a,{configs:p.value,filters:i.value,isEditing:!0,"rows-per-page":10,onSelect:h},null,8,["configs","filters"])]),_:1}),u(b,{open:n.value},null,8,["open"])],64)}}};export{A as default};

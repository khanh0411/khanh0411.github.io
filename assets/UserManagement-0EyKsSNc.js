import{y as W,r as v,z as B,ca as X,cb as D,cc as C,_ as q,d as y,o as F,c as L,a as o,e as r,w as h,g as _,t as k,u as E,D as R,F as j,c4 as Y,c5 as Z,c2 as G,b as M,c7 as ee,j as le,m as te,i as I}from"./index-Ct7bBCdm.js";import{n as N}from"./system.utils-B3Z3hxQT.js";import{A as T}from"./index-C_HyQ6wr.js";import{u as oe}from"./auth.store-DOR3p7Kt.js";class P{constructor(x,f,m,c,i,a,e,t){this.user_id=x||"",this.full_name=f||"",this.avatar_url=m||"",this.dob=c||"",this.email=i||"",this.role=a||"",this.status=e||"",this.mapped_id=t}}const z=W("user",()=>{const V=v(null),x=a=>{for(const[e,t]of Object.entries(D))if(t===a)return e;return"unknown"},f=a=>{for(const[e,t]of Object.entries(C))if(t===a)return e;return"Unknown"};async function m(){var a;try{const e=await B.post("/api/admin/allusers"),t=e.data.map((d,p)=>new P(d.user_id,d.full_name,d.avatar_url,X(d.dob),d.email,x(d.role),f(d.status),p+1));return{...e,data:t}}catch(e){return e instanceof T?{errors:((a=e.response.data)==null?void 0:a.messages)||[]}:{errors:["Something wrong, please try later"]}}}async function c(a,e,t){var d;try{const p=await B.post("/api/admin/setrole",{user_id:a,role:e,status:t});return console.log(p),p}catch(p){return p instanceof T?{errors:((d=p.response.data)==null?void 0:d.messages)||[]}:{errors:["Something wrong, please try later"]}}}async function i(a){var e;try{const t=await B.post("/api/admin/delete",{user_id:a});return console.log(t),t}catch(t){return t instanceof T?{errors:((e=t.response.data)==null?void 0:e.messages)||[]}:{errors:["Something wrong, please try later"]}}}return{user:V,handleGetUsers:m,handleUpdateUser:c,handleDeleteUser:i}}),se={__name:"AddUserForm",emits:["submit"],setup(V,{emit:x}){const f=x,m=oe(),c=v(!1),i={full_name:"",dob:"",email:"",password:"",role:"",status:""},a={full_name:"",dob:"",email:"",password:"",role:"",status:""},e=v({...a}),t=v({...i}),d=Object.keys(D).map(n=>({value:D[n].toString(),label:n.charAt(0)+n.slice(1).toLowerCase()})),p=Object.keys(C).map(n=>({value:C[n].toString(),label:n.charAt(0)+n.slice(1).toLowerCase()}));async function S(){let n=!0;if(t.value={...i},e.value.full_name.trim()===""&&(t.value.full_name="This field is required",n=!1),e.value.dob.trim()===""&&(t.value.dob="This field is required",n=!1),e.value.email.trim()===""?(t.value.email="This field is required",n=!1):Y(e.value.email.trim())||(t.value.email="This field is not in email format",n=!1),e.value.password.trim()===""?(t.value.password="This field is required",n=!1):Z(e.value.password.trim())||(t.value.password="Passwords need to be 8 characters or more and have a combination of uppercase letters, lowercase letters, numbers and symbols.",n=!1),e.value.role.trim()===""&&(t.value.role="This field is required",n=!1),e.value.status.trim()===""&&(t.value.status="This field is required",n=!1),n){c.value=!0;const l=await m.handleCreateUser(e.value);c.value=!1,l.errors?N(l.errors,"error"):(f("submit"),G({text:" Create successfully",type:"success"}),e.value={...a})}}return(n,l)=>{const s=y("GenericInput"),b=y("SmallComponent"),U=y("GenericSelect"),O=y("FullScreenLoading");return F(),L(j,null,[o("form",{onSubmit:R(S,["prevent"]),class:"space-y-4"},[o("div",null,[l[6]||(l[6]=o("label",{for:"fullName",class:"block text-sm font-medium text-gray-700"},"Full Name",-1)),r(s,{id:"fullName",modelValue:e.value.full_name,"onUpdate:modelValue":l[0]||(l[0]=u=>e.value.full_name=u),type:"text",placeholder:"Enter full name",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50 invalid:border-red-500",error:!!t.value.full_name},null,8,["modelValue","error"]),r(b,null,{default:h(()=>[_(k(t.value.full_name),1)]),_:1})]),o("div",null,[l[7]||(l[7]=o("label",{for:"dob",class:"block text-sm font-medium text-gray-700"},"Date of Birth",-1)),r(s,{id:"dob",modelValue:e.value.dob,"onUpdate:modelValue":l[1]||(l[1]=u=>e.value.dob=u),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",error:!!t.value.dob},null,8,["modelValue","error"]),r(b,null,{default:h(()=>[_(k(t.value.dob),1)]),_:1})]),o("div",null,[l[8]||(l[8]=o("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),r(s,{id:"email",modelValue:e.value.email,"onUpdate:modelValue":l[2]||(l[2]=u=>e.value.email=u),type:"email",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Enter email address",error:!!t.value.email},null,8,["modelValue","error"]),r(b,null,{default:h(()=>[_(k(t.value.email),1)]),_:1})]),o("div",null,[l[9]||(l[9]=o("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Password",-1)),r(s,{id:"password",modelValue:e.value.password,"onUpdate:modelValue":l[3]||(l[3]=u=>e.value.password=u),type:"password",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Enter password",error:!!t.value.password},null,8,["modelValue","error"]),r(b,null,{default:h(()=>[_(k(t.value.password),1)]),_:1})]),o("div",null,[l[10]||(l[10]=o("label",{class:"block text-sm font-medium text-gray-700"},"Role",-1)),r(U,{options:E(d),placeholder:"Select role",modelValue:e.value.role,"onUpdate:modelValue":l[4]||(l[4]=u=>e.value.role=u),error:!!t.value.role},null,8,["options","modelValue","error"]),r(b,null,{default:h(()=>[_(k(t.value.role),1)]),_:1})]),o("div",null,[l[11]||(l[11]=o("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),r(U,{options:E(p),placeholder:"Select status",modelValue:e.value.status,"onUpdate:modelValue":l[5]||(l[5]=u=>e.value.status=u),error:!!t.value.status},null,8,["options","modelValue","error"]),r(b,null,{default:h(()=>[_(k(t.value.status),1)]),_:1})]),l[12]||(l[12]=o("div",{class:"flex justify-end"},[o("button",{type:"submit",class:"btn btn-blue"},"Save")],-1))],32),r(O,{open:c.value},null,8,["open"])],64)}}},ae=q(se,[["__scopeId","data-v-36293a38"]]),re={__name:"EditUserForm",props:{user:{type:P,required:!0}},emits:["submit"],setup(V,{emit:x}){const f=x,m=V,c=z(),i=v(!1),a={full_name:"",dob:"",email:"",password:"",role:"",status:""},e=v({...a}),t=Object.keys(D).map(l=>({value:D[l].toString(),label:l.charAt(0)+l.slice(1).toLowerCase()})),d=Object.keys(C).map(l=>({value:C[l].toString(),label:l.charAt(0)+l.slice(1).toLowerCase()}));function p(l){const s=l.toUpperCase();return D[s]||null}function S(l){const s=l.toUpperCase();return C[s]||null}async function n(){i.value=!0;const l=await c.handleUpdateUser(m.user.user_id,Number(e.value.role),Number(e.value.status));i.value=!1,l.errors?N(l.errors,"error"):(f("submit"),G({text:" Changed successfully",type:"success"}),e.value={...a})}return M(()=>{e.value={...a,...m.user,role:p(m.user.role),status:S(m.user.status)}}),(l,s)=>{const b=y("GenericInput"),U=y("GenericSelect"),O=y("FullScreenLoading");return F(),L(j,null,[o("form",{onSubmit:R(n,["prevent"]),class:"space-y-4"},[o("div",null,[s[5]||(s[5]=o("label",{for:"fullName",class:"block text-sm font-medium text-gray-700"},"Full Name",-1)),r(b,{id:"fullName",modelValue:e.value.full_name,"onUpdate:modelValue":s[0]||(s[0]=u=>e.value.full_name=u),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Enter full name",disabled:!0},null,8,["modelValue"])]),o("div",null,[s[6]||(s[6]=o("label",{for:"dob",class:"block text-sm font-medium text-gray-700"},"Date of Birth",-1)),r(b,{id:"dob",modelValue:e.value.dob,"onUpdate:modelValue":s[1]||(s[1]=u=>e.value.dob=u),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:!0},null,8,["modelValue"])]),o("div",null,[s[7]||(s[7]=o("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),r(b,{id:"email",modelValue:e.value.email,"onUpdate:modelValue":s[2]||(s[2]=u=>e.value.email=u),type:"email",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Enter email address",disabled:!0},null,8,["modelValue"])]),o("div",null,[s[8]||(s[8]=o("label",{class:"block text-sm font-medium text-gray-700"},"Role",-1)),r(U,{options:E(t),placeholder:"Select role",modelValue:e.value.role,"onUpdate:modelValue":s[3]||(s[3]=u=>e.value.role=u)},null,8,["options","modelValue"])]),o("div",null,[s[9]||(s[9]=o("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),r(U,{options:E(d),placeholder:"Select status",modelValue:e.value.status,"onUpdate:modelValue":s[4]||(s[4]=u=>e.value.status=u)},null,8,["options","modelValue"])]),s[10]||(s[10]=o("div",{class:"flex justify-end"},[o("button",{type:"submit",class:"btn btn-blue"},"Save")],-1))],32),r(O,{open:i.value},null,8,["open"])],64)}}},ne=q(re,[["__scopeId","data-v-dac92a1a"]]),ue={class:"flex items-center justify-between flex-wrap gap-3.5 mb-3 mx-5"},ie={class:"flex items-center justify-between flex-wrap gap-3.5"},de={class:"relative w-[250px]"},be={__name:"UserManagement",setup(V){const x=z(),f=v(!1),m=v(!1),c=v(!1),i=v(null),a=v(""),e=v({searchQuery:a.value}),t=v(new ee({cols:[{title:"ID",key:"mapped_id",i18n:"",width:"10%",sortable:!0},{title:"Name",key:"full_name",i18n:"",width:"18%",sortable:!0},{title:"DOB",key:"dob",i18n:"",width:"18%",sortable:!0},{title:"Email",key:"email",i18n:"",width:"18%",sortable:!1},{title:"Status",key:"status",i18n:"",width:"18%",sortable:!1},{title:"Role",key:"role",i18n:"",width:"18%",sortable:!1}],rows:[],uniqueField:"mapped_id",isShowActionIconOnly:!0,showMoreButton:!1,editButton:!0,deleteButton:!0,height:800,pagination:{page:1,totals:5}}));async function d(){c.value=!0;const w=await x.handleGetUsers();c.value=!1,w.errors?N(w.errors,"error"):t.value.rows=w.data}function p(){e.value.searchQuery=a.value}function S(){a.value="",e.value.searchQuery="",d()}function n(){S(),f.value=!1}function l(){f.value=!0}function s(w){f.value=!0,i.value=w}function b(){m.value=!1,i.value=null}function U(w){m.value=!0,i.value=w}async function O(){c.value=!0;const w=await x.handleDeleteUser(i.value.user_id);c.value=!1,w.errors?N(w.errors,"error"):(G({text:"Delete successfully",type:"success"}),m.value=!1,S())}function u(){b()}return M(async()=>{d()}),(w,g)=>{const Q=y("GenericTable"),$=y("GenericDialog"),H=y("AdminLayout"),J=y("ConfirmDialog"),K=y("FullScreenLoading");return F(),L(j,null,[r(H,null,{default:h(()=>[o("form",ue,[o("div",ie,[o("div",de,[le(o("input",{"onUpdate:modelValue":g[0]||(g[0]=A=>a.value=A),type:"text",class:"w-full h-10 pl-4 pr-12 border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-[#669ee9] focus:border-[#669ee9]",placeholder:"Search",onInput:p},null,544),[[te,a.value]]),g[3]||(g[3]=o("span",{class:"absolute right-0 top-0 h-full px-3 flex items-center text-[#669ee9] border-l border-gray-200"},[o("i",{class:"bi bi-search"})],-1))])]),o("div",{class:"flex items-center justify-between gap-3.5"},[o("button",{type:"button",class:"flex items-center justify-center w-[159px] h-10 text-[#669ee9] bg-white border border-gray-200 rounded hover:bg-[#669ee9] hover:text-white transition-colors duration-150",onClick:l},g[4]||(g[4]=[o("i",{class:"bi bi-plus-lg"},null,-1),o("span",{class:"ml-2.5"},"Add New",-1)])),o("button",{onClick:S,type:"button",class:"flex items-center justify-center w-[47px] h-10 text-[#669ee9] bg-white border border-gray-200 rounded hover:bg-[#669ee9] hover:text-white transition-colors duration-150"},g[5]||(g[5]=[o("i",{class:"bi bi-arrow-repeat"},null,-1)]))])]),r(Q,{configs:t.value,filters:e.value,onClick:console.log,onShow:console.log,onEdit:s,onDelete:U,onPageChange:console.log,onSort:console.log},null,8,["configs","filters","onClick","onShow","onPageChange","onSort"]),r($,{modelValue:f.value,"onUpdate:modelValue":g[1]||(g[1]=A=>f.value=A),size:"3xl",title:i.value?"Update User  ":"Create User",onClose:b},{default:h(()=>[i.value?(F(),I(E(ne),{key:0,user:i.value,onSubmit:n},null,8,["user"])):(F(),I(E(ae),{key:1,onSubmit:n}))]),_:1},8,["modelValue","title"])]),_:1}),r(J,{modelValue:m.value,"onUpdate:modelValue":g[2]||(g[2]=A=>m.value=A),onAccept:O,onDeny:u},null,8,["modelValue"]),r(K,{open:c.value},null,8,["open"])],64)}}};export{be as default};

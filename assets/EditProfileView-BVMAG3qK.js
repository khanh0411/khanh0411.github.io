import{_ as $,r as u,N as Q,O as A,e as W,c as V,k as n,l as v,F as q,B as X,S as Y,E as c,P as z,j as S,o as C,a as l,A as r,I as J,b as p,t as Z,Q as ee,u as le,U as x}from"./index-Cww7t7_x.js";import{P as te}from"./ProfileView-BKnhe619.js";import{u as se}from"./video.store-Cv44rKXv.js";const oe={class:"w-full bg-gray-50"},ae={class:"mx-auto p-6 space-y-6"},ne={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},ie={class:"lg:sticky lg:top-6 h-fit space-y-6"},re={class:"bg-white rounded-2xl shadow-xl overflow-hidden"},ue={class:"px-6 pb-6"},de={class:"flex justify-center"},ce={class:"relative -mt-16 mb-4"},pe=["src"],fe={key:0,class:"text-center text-sm text-blue-600 mb-4"},me={class:"text-center mb-6"},ve={class:"text-2xl font-bold text-gray-800"},be={class:"text-gray-600"},ge={class:"bg-gray-50 rounded-xl p-4"},xe={class:"flex items-center justify-between mb-2"},he={class:"font-semibold text-gray-800"},ye={class:"flex items-center justify-between"},_e={class:"font-semibold text-blue-600"},we={class:"flex items-center justify-between"},ke={class:"font-semibold text-blue-600"},Ve={class:"flex items-center justify-between"},Se={class:"font-semibold text-blue-600"},Ce={class:"flex items-center justify-between"},Ee={class:"font-semibold text-blue-600"},Ue={class:"bg-white rounded-2xl shadow-xl p-8"},Ne={class:"flex items-center space-x-3"},Pe={class:"flex items-center"},je={class:"lg:col-span-2 space-y-6"},Me={class:"bg-white rounded-2xl shadow-xl p-8"},Te={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},De={class:"col-span-2"},Ge={class:"mt-6 flex justify-end"},Ae={class:"bg-white rounded-2xl shadow-xl p-8"},Be={class:"space-y-4"},Ie="https://i.pravatar.cc/150?img=3",Re={__name:"EditProfileView",setup(Fe){const t=u({CoursesSignedUp:0,CoursesSuccessfullyCompleted:0,profile:{}}),N=u({full_name:"",coin:"",dob:"",email:"",avatar_url:"",status:"",role:"",code:"",created_at:"",updated_at:"",email_contact:"",gender:"",phone_contact:""}),o=u({...N.value}),h=Q(),P=se(),j=u(null),y=u(""),b=u(""),_=u(""),M=u(!0),d=u(!1),E=u(""),m=u(!1),T=u("");async function B(s){const e=s.target.files[0],f=Math.floor(new Date().getTime()/1e3),w=`picture/${t.value.profile.avatar_url}/${f}`;if(await P.handleUploadVideo(e,w)){const k={...t.value,profile:{...t.value.profile,gender:Number(t.value.profile.gender),role:D(t.value.profile.role),avatar_url:w}},g=await h.handleEditProfile(k.profile);m.value=!1,g.errors?c({text:g.errors,type:"error"}):(c({text:"Update successfully",type:"success"}),U())}}const I=()=>{j.value.click()};function R(s){return{[x.ADMIN]:"ADMIN",[x.TEACHER]:"TEACHER",[x.STUDENT]:"STUDENT"}[s]||"UNKNOWN"}const F=Object.keys(A).map(s=>({value:A[s].toString(),label:s.charAt(0)+s.slice(1).toLowerCase()}));async function U(){m.value=!0;const s=X(Y.accessToken),e=await h.handleGetProfile(s);m.value=!1,e.errors?c({text:e.errors,type:"error"}):(t.value={...e.data,profile:{...e.data.profile,dob:z(e.data.profile.dob),role:R(e.data.profile.role)}},console.log(t.value),L(t.value.profile.avatar_url))}async function L(s){const e=await P.handleFetchVideo(s);e.error&&c({text:e.errors,type:"error"}),T.value=e.url}function D(s){if(s){const e=Object.keys(x).find(i=>i.toLowerCase()===s.toLowerCase());return e?x[e]:null}}async function O(){let s=!0;if(o.value={...N.value},t.value.profile.full_name.trim()===""&&(o.value.full_name="Họ và tên không được để trống.",s=!1),t.value.profile.dob||(o.value.dob="Ngày sinh không được để trống.",s=!1),t.value.profile.email_contact?/\S+@\S+\.\S+/.test(t.value.profile.email_contact)||(o.value.email_contact="Email không hợp lệ.",s=!1):(o.value.email_contact="Email liên hệ không được để trống.",s=!1),t.value.profile.phone_contact?/^\d{10}$/.test(t.value.profile.phone_contact)||(o.value.phone_contact="Số điện thoại không hợp lệ.",s=!1):(o.value.phone_contact="Số điện thoại không được để trống.",s=!1),t.value.profile.gender||(o.value.gender="Giới tính không được để trống.",s=!1),s){m.value=!0;const e={...t.value,profile:{...t.value.profile,gender:Number(t.value.profile.gender),role:D(t.value.profile.role)}},i=await h.handleEditProfile(e.profile);m.value=!1,i.errors?c({text:i.errors,type:"error"}):(c({text:"Update successfully",type:"success"}),U())}}const H=()=>{d.value?(d.value=!1,E.value=""):d.value=!0};async function K(){if(b.value===_.value){const s={oldPassword:y.value,newPassword:b.value},e=await h.handleChangePassword(s);e.errors?c({text:e.errors,type:"error"}):(c({text:"Update successfully",type:"success"}),y.value="",b.value="",_.value="")}else c({text:"Mật khẩu mới và xác nhận mật khẩu không trùng nhau",type:"error"})}return W(()=>{U()}),(s,e)=>{const i=S("GenericInput"),f=S("SmallComponent"),w=S("GenericSelect"),G=S("FullScreenLoading");return C(),V(q,null,[n(te,null,{default:v(()=>{var k,g;return[l("div",oe,[l("div",ae,[e[31]||(e[31]=l("div",{class:"text-center py-8"},[l("h1",{class:"text-4xl font-bold text-gray-800 mb-2"},"Hồ Sơ Cá Nhân"),l("p",{class:"text-gray-600"},"Quản lý thông tin cá nhân của bạn")],-1)),l("div",ne,[l("div",ie,[l("div",re,[e[15]||(e[15]=l("div",{class:"h-32 bg-gradient-to-r from-blue-500 to-purple-600"},null,-1)),l("div",ue,[l("div",de,[l("div",ce,[l("img",{src:T.value||Ie,alt:"Profile Picture",class:"w-32 h-32 rounded-full border-4 border-white shadow-lg object-cover"},null,8,pe),l("button",{onClick:I,class:"absolute bottom-0 right-0 bg-blue-600 text-white p-2 rounded-full hover:bg-blue-700 transition-all duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},e[9]||(e[9]=[l("i",{class:"bi bi-camera-fill text-lg"},null,-1)]))])]),l("input",{type:"file",ref_key:"fileInput",ref:j,onChange:B,accept:"image/*",class:"hidden"},null,544),E.value?(C(),V("div",fe,r(E.value),1)):J("",!0),l("div",me,[l("h2",ve,r((k=t.value.profile)==null?void 0:k.full_name),1),l("p",be,r((g=t.value.profile)==null?void 0:g.email),1)]),l("div",ge,[l("div",xe,[e[10]||(e[10]=l("span",{class:"text-gray-600"},"Mã người dùng:",-1)),l("span",he,r(t.value.profile.code),1)]),l("div",ye,[e[11]||(e[11]=l("span",{class:"text-gray-600"},"Số coin:",-1)),l("span",_e,r(t.value.profile.coin),1)]),l("div",we,[e[12]||(e[12]=l("span",{class:"text-gray-600"},"Vai trò:",-1)),l("span",ke,r(t.value.profile.role),1)]),l("div",Ve,[e[13]||(e[13]=l("span",{class:"text-gray-600"},"Khóa học tham gia:",-1)),l("span",Se,r(t.value.CoursesSignedUp),1)]),l("div",Ce,[e[14]||(e[14]=l("span",{class:"text-gray-600"},"Khóa học hoàn thành:",-1)),l("span",Ee,r(t.value.CoursesSuccessfullyCompleted),1)])])])]),l("div",Ue,[e[17]||(e[17]=l("h2",{class:"text-2xl font-bold text-gray-800 mb-6 flex items-center"},[l("i",{class:"bi bi-bell-fill mr-2 text-blue-600"}),p(" Cài đặt thông báo ")],-1)),l("div",Ne,[l("div",Pe,[Z(l("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=a=>M.value=a),class:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},null,512),[[ee,M.value]]),e[16]||(e[16]=l("label",{class:"ml-2 text-gray-700"},"Nhận thông báo qua email",-1))])])])]),l("div",je,[l("div",Me,[e[25]||(e[25]=l("h2",{class:"text-2xl font-bold text-gray-800 mb-6 flex items-center"},[l("i",{class:"bi bi-person-fill mr-2 text-blue-600"}),p(" Thông tin cá nhân ")],-1)),l("div",Te,[l("div",De,[e[18]||(e[18]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Họ và tên",-1)),n(i,{modelValue:t.value.profile.full_name,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.profile.full_name=a),type:"text",disabled:!d.value,error:!!o.value.full_name},null,8,["modelValue","disabled","error"]),n(f,null,{default:v(()=>[p(r(o.value.full_name),1)]),_:1})]),l("div",null,[e[19]||(e[19]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ngày sinh",-1)),n(i,{modelValue:t.value.profile.dob,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.profile.dob=a),type:"date",disabled:!d.value,error:!!o.value.dob},null,8,["modelValue","disabled","error"]),n(f,null,{default:v(()=>[p(r(o.value.dob),1)]),_:1})]),l("div",null,[e[20]||(e[20]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email liên hệ",-1)),n(i,{modelValue:t.value.profile.email_contact,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.profile.email_contact=a),type:"email",disabled:!d.value,error:!!o.value.email_contact},null,8,["modelValue","disabled","error"]),n(f,null,{default:v(()=>[p(r(o.value.email_contact),1)]),_:1})]),l("div",null,[e[21]||(e[21]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Số điện thoại",-1)),n(i,{modelValue:t.value.profile.phone_contact,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.profile.phone_contact=a),type:"email",disabled:!d.value,error:!!o.value.phone_contact},null,8,["modelValue","disabled","error"]),n(f,null,{default:v(()=>[p(r(o.value.phone_contact),1)]),_:1})]),l("div",null,[e[22]||(e[22]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Giới tính",-1)),n(w,{options:le(F),placeholder:"Chọn giới tính",modelValue:t.value.profile.gender,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.profile.gender=a),disabled:!d.value,error:!!o.value.gender},null,8,["options","modelValue","disabled","error"]),n(f,null,{default:v(()=>[p(r(o.value.gender),1)]),_:1})])]),l("div",Ge,[d.value?(C(),V("button",{key:1,onClick:O,class:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-all duration-300 flex items-center"},e[24]||(e[24]=[l("i",{class:"bi bi-check2"},null,-1),l("span",{class:"ml-2"},"Lưu thay đổi",-1)]))):(C(),V("button",{key:0,onClick:H,class:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-300 flex items-center"},e[23]||(e[23]=[l("i",{class:"bi bi-pencil-fill"},null,-1),l("span",{class:"ml-2"},"Sửa thông tin",-1)])))])]),l("div",Ae,[e[30]||(e[30]=l("h2",{class:"text-2xl font-bold text-gray-800 mb-6 flex items-center"},[l("i",{class:"bi bi-shield-lock-fill mr-2 text-blue-600"}),p(" Đổi mật khẩu ")],-1)),l("div",Be,[l("div",null,[e[26]||(e[26]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mật khẩu hiện tại",-1)),n(i,{modelValue:y.value,"onUpdate:modelValue":e[6]||(e[6]=a=>y.value=a),type:"password"},null,8,["modelValue"])]),l("div",null,[e[27]||(e[27]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mật khẩu mới",-1)),n(i,{modelValue:b.value,"onUpdate:modelValue":e[7]||(e[7]=a=>b.value=a),type:"password"},null,8,["modelValue"])]),l("div",null,[e[28]||(e[28]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Xác nhận mật khẩu mới",-1)),n(i,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=a=>_.value=a),type:"password"},null,8,["modelValue"])])]),l("div",{class:"mt-6 flex justify-end"},[l("button",{onClick:K,class:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-300 flex items-center"},e[29]||(e[29]=[l("i",{class:"bi bi-key-fill mr-2"},null,-1),p(" Cập nhật mật khẩu ")]))])])])])])])]}),_:1}),n(G,{open:m.value},null,8,["open"])],64)}}},Ke=$(Re,[["__scopeId","data-v-89316aa1"]]);export{Ke as default};

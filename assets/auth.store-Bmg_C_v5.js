import{c8 as p,r as d,c9 as n,cd as h,S as m,v as f,ca as o,cf as l}from"./index-D8gAyzM3.js";function y(a){return String(a).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}function S(a){return String(a).toLowerCase().match(/^(?:(?=.*[a-z])(?:(?=.*[A-Z])(?=.*[\d\W])|(?=.*\W)(?=.*\d))|(?=.*\W)(?=.*[A-Z])(?=.*\d)).{8,}$/)}const A=p("auth",()=>{const a=d(null);async function c(r){var s;try{const e=await n.post("/api/auth/login",r);h(m.accessToken,e.data.token,7);const t=f(e.data.token);return a.value=t.user,{user:t.user}}catch(e){return e instanceof o?{errors:((s=e.response.data)==null?void 0:s.message)||[]}:{errors:["Something wrong, please try later"]}}}async function i(r){var s;try{return await n.post("/api/auth/register",r)}catch(e){return e instanceof o?{errors:((s=e.response.data)==null?void 0:s.message)||[]}:{errors:["Something wrong, please try later"]}}}async function u(r){var s;try{return await l.post("/api/auth/forgotPassword",{email:r})}catch(e){return e instanceof o?{errors:((s=e.response.data)==null?void 0:s.message)||[]}:{errors:["Something wrong, please try later"]}}}async function g(r){var s;try{return await n.post("/api/auth/resetPassword",{newPassword:r})}catch(e){return e instanceof o?{errors:((s=e.response.data)==null?void 0:s.message)||[]}:{errors:["Something wrong, please try later"]}}}return{user:a,handleLogin:c,handleCreateUser:i,handleForgetPassWord:u,handleResetPassWord:g}});export{S as a,y as i,A as u};

import{c8 as J,r as v,c9 as T,P as K,ca as A,U as C,cg as E,_ as I,j as y,o as B,c as L,a as s,k as r,l as h,b as k,D,u as O,W as q,F as j,E as V,e as R,ce as X,x as Y,C as Z,s as G}from"./index-DYsdoSjd.js";import{u as ee,i as le,a as te}from"./auth.store-nR86EFHm.js";class M{constructor(x,f,m,c,i,a,e,t){this.user_id=x||"",this.full_name=f||"",this.avatar_url=m||"",this.dob=c||"",this.email=i||"",this.role=a||"",this.status=e||"",this.mapped_id=t}}const P=J("user",()=>{const _=v(null),x=a=>{for(const[e,t]of Object.entries(C))if(t===a)return e;return"unknown"},f=a=>{for(const[e,t]of Object.entries(E))if(t===a)return e;return"Unknown"};async function m(){var a;try{const e=await T.post("/api/users/allusers"),t=e.data.map((d,p)=>new M(d.user_id,d.full_name,d.avatar_url,K(d.dob),d.email,x(d.role),f(d.status),p+1));return{...e,data:t}}catch(e){return e instanceof A?{errors:((a=e.response.data)==null?void 0:a.message)||[]}:{errors:["Something wrong, please try later"]}}}async function c(a,e,t){var d;try{const p=await T.post("/api/admin/setrole",{user_id:a,role:e,status:t});return console.log(p),p}catch(p){return p instanceof A?{errors:((d=p.response.data)==null?void 0:d.message)||[]}:{errors:["Something wrong, please try later"]}}}async function i(a){var e;try{const t=await T.post("/api/admin/delete",{user_id:a});return console.log(t),t}catch(t){return t instanceof A?{errors:((e=t.response.data)==null?void 0:e.message)||[]}:{errors:["Something wrong, please try later"]}}}return{user:_,handleGetUsers:m,handleUpdateUser:c,handleDeleteUser:i}}),se={__name:"AddUserForm",emits:["submit"],setup(_,{emit:x}){const f=x,m=ee(),c=v(!1),i={full_name:"",dob:"",email:"",password:"",role:"",status:""},a={full_name:"",dob:"",email:"",password:"",role:"",status:""},e=v({...a}),t=v({...i}),d=Object.keys(C).map(n=>({value:C[n].toString(),label:n.charAt(0)+n.slice(1).toLowerCase()})),p=Object.keys(E).map(n=>({value:E[n].toString(),label:n.charAt(0)+n.slice(1).toLowerCase()}));async function S(){let n=!0;if(t.value={...i},e.value.full_name.trim()===""&&(t.value.full_name="This field is required",n=!1),e.value.dob.trim()===""&&(t.value.dob="This field is required",n=!1),e.value.email.trim()===""?(t.value.email="This field is required",n=!1):le(e.value.email.trim())||(t.value.email="This field is not in email format",n=!1),e.value.password.trim()===""?(t.value.password="This field is required",n=!1):te(e.value.password.trim())||(t.value.password="Passwords need to be 8 characters or more and have a combination of uppercase letters, lowercase letters, numbers and symbols.",n=!1),e.value.role.trim()===""&&(t.value.role="This field is required",n=!1),e.value.status.trim()===""&&(t.value.status="This field is required",n=!1),n){c.value=!0;const l=await m.handleCreateUser(e.value);c.value=!1,l.errors?V({text:l.errors,type:"error"}):(f("submit"),V({text:" Create successfully",type:"success"}),e.value={...a})}}return(n,l)=>{const o=y("GenericInput"),b=y("SmallComponent"),U=y("GenericSelect"),F=y("FullScreenLoading");return B(),L(j,null,[s("form",{onSubmit:q(S,["prevent"]),class:"space-y-4"},[s("div",null,[l[6]||(l[6]=s("label",{for:"fullName",class:"block text-sm font-medium text-gray-700"},"Full Name",-1)),r(o,{id:"fullName",modelValue:e.value.full_name,"onUpdate:modelValue":l[0]||(l[0]=u=>e.value.full_name=u),type:"text",placeholder:"Enter full name",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50 invalid:border-red-500",error:!!t.value.full_name},null,8,["modelValue","error"]),r(b,null,{default:h(()=>[k(D(t.value.full_name),1)]),_:1})]),s("div",null,[l[7]||(l[7]=s("label",{for:"dob",class:"block text-sm font-medium text-gray-700"},"Date of Birth",-1)),r(o,{id:"dob",modelValue:e.value.dob,"onUpdate:modelValue":l[1]||(l[1]=u=>e.value.dob=u),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",error:!!t.value.dob},null,8,["modelValue","error"]),r(b,null,{default:h(()=>[k(D(t.value.dob),1)]),_:1})]),s("div",null,[l[8]||(l[8]=s("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),r(o,{id:"email",modelValue:e.value.email,"onUpdate:modelValue":l[2]||(l[2]=u=>e.value.email=u),type:"email",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Enter email address",error:!!t.value.email},null,8,["modelValue","error"]),r(b,null,{default:h(()=>[k(D(t.value.email),1)]),_:1})]),s("div",null,[l[9]||(l[9]=s("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Password",-1)),r(o,{id:"password",modelValue:e.value.password,"onUpdate:modelValue":l[3]||(l[3]=u=>e.value.password=u),type:"password",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Enter password",error:!!t.value.password},null,8,["modelValue","error"]),r(b,null,{default:h(()=>[k(D(t.value.password),1)]),_:1})]),s("div",null,[l[10]||(l[10]=s("label",{class:"block text-sm font-medium text-gray-700"},"Role",-1)),r(U,{options:O(d),placeholder:"Select role",modelValue:e.value.role,"onUpdate:modelValue":l[4]||(l[4]=u=>e.value.role=u),error:!!t.value.role},null,8,["options","modelValue","error"]),r(b,null,{default:h(()=>[k(D(t.value.role),1)]),_:1})]),s("div",null,[l[11]||(l[11]=s("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),r(U,{options:O(p),placeholder:"Select status",modelValue:e.value.status,"onUpdate:modelValue":l[5]||(l[5]=u=>e.value.status=u),error:!!t.value.status},null,8,["options","modelValue","error"]),r(b,null,{default:h(()=>[k(D(t.value.status),1)]),_:1})]),l[12]||(l[12]=s("div",{class:"flex justify-end"},[s("button",{type:"submit",class:"btn btn-blue"},"Save")],-1))],32),r(F,{open:c.value},null,8,["open"])],64)}}},oe=I(se,[["__scopeId","data-v-27bae460"]]),ae={__name:"EditUserForm",props:{user:{type:M,required:!0}},emits:["submit"],setup(_,{emit:x}){const f=x,m=_,c=P(),i=v(!1),a={full_name:"",dob:"",email:"",password:"",role:"",status:""},e=v({...a}),t=Object.keys(C).map(l=>({value:C[l].toString(),label:l.charAt(0)+l.slice(1).toLowerCase()})),d=Object.keys(E).map(l=>({value:E[l].toString(),label:l.charAt(0)+l.slice(1).toLowerCase()}));function p(l){const o=l.toUpperCase();return C[o]||null}function S(l){const o=l.toUpperCase();return E[o]||null}async function n(){i.value=!0;const l=await c.handleUpdateUser(m.user.user_id,Number(e.value.role),Number(e.value.status));i.value=!1,l.errors?V({text:l.errors,type:"error"}):(f("submit"),V({text:" Changed successfully",type:"success"}),e.value={...a})}return R(()=>{e.value={...a,...m.user,role:p(m.user.role),status:S(m.user.status)}}),(l,o)=>{const b=y("GenericInput"),U=y("GenericSelect"),F=y("FullScreenLoading");return B(),L(j,null,[s("form",{onSubmit:q(n,["prevent"]),class:"space-y-4"},[s("div",null,[o[5]||(o[5]=s("label",{for:"fullName",class:"block text-sm font-medium text-gray-700"},"Full Name",-1)),r(b,{id:"fullName",modelValue:e.value.full_name,"onUpdate:modelValue":o[0]||(o[0]=u=>e.value.full_name=u),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Enter full name",disabled:!0},null,8,["modelValue"])]),s("div",null,[o[6]||(o[6]=s("label",{for:"dob",class:"block text-sm font-medium text-gray-700"},"Date of Birth",-1)),r(b,{id:"dob",modelValue:e.value.dob,"onUpdate:modelValue":o[1]||(o[1]=u=>e.value.dob=u),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:!0},null,8,["modelValue"])]),s("div",null,[o[7]||(o[7]=s("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),r(b,{id:"email",modelValue:e.value.email,"onUpdate:modelValue":o[2]||(o[2]=u=>e.value.email=u),type:"email",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Enter email address",disabled:!0},null,8,["modelValue"])]),s("div",null,[o[8]||(o[8]=s("label",{class:"block text-sm font-medium text-gray-700"},"Role",-1)),r(U,{options:O(t),placeholder:"Select role",modelValue:e.value.role,"onUpdate:modelValue":o[3]||(o[3]=u=>e.value.role=u)},null,8,["options","modelValue"])]),s("div",null,[o[9]||(o[9]=s("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),r(U,{options:O(d),placeholder:"Select status",modelValue:e.value.status,"onUpdate:modelValue":o[4]||(o[4]=u=>e.value.status=u)},null,8,["options","modelValue"])]),o[10]||(o[10]=s("div",{class:"flex justify-end"},[s("button",{type:"submit",class:"btn btn-blue"},"Save")],-1))],32),r(F,{open:i.value},null,8,["open"])],64)}}},re=I(ae,[["__scopeId","data-v-7e49bc52"]]),ne={class:"flex items-center justify-between flex-wrap gap-3.5 mb-3 mx-5"},ue={class:"flex items-center justify-between flex-wrap gap-3.5"},ie={class:"relative w-[250px]"},ce={__name:"UserManagement",setup(_){const x=P(),f=v(!1),m=v(!1),c=v(!1),i=v(null),a=v(""),e=v({searchQuery:a.value}),t=v(new X({cols:[{title:"ID",key:"mapped_id",i18n:"",width:"10%",sortable:!0},{title:"Name",key:"full_name",i18n:"",width:"18%",sortable:!0},{title:"DOB",key:"dob",i18n:"",width:"18%",sortable:!1},{title:"Email",key:"email",i18n:"",width:"18%",sortable:!1},{title:"Status",key:"status",i18n:"",width:"18%",sortable:!1},{title:"Role",key:"role",i18n:"",width:"18%",sortable:!1}],rows:[],uniqueField:"mapped_id",isShowActionIconOnly:!0,showMoreButton:!1,editButton:!0,deleteButton:!0,height:800,pagination:{page:1,totals:5}}));async function d(){c.value=!0;const w=await x.handleGetUsers();c.value=!1,w.errors?V({text:w.errors,type:"error"}):t.value.rows=w.data}function p(){e.value.searchQuery=a.value}function S(){a.value="",e.value.searchQuery="",d()}function n(){S(),f.value=!1}function l(){f.value=!0}function o(w){f.value=!0,i.value=w}function b(){m.value=!1,i.value=null}function U(w){m.value=!0,i.value=w}async function F(){c.value=!0;const w=await x.handleDeleteUser(i.value.user_id);c.value=!1,w.errors?V({text:w.errors,type:"error"}):(V({text:"Delete successfully",type:"success"}),m.value=!1,S())}function u(){b()}return R(async()=>{d()}),(w,g)=>{const z=y("GenericTable"),Q=y("GenericDialog"),$=y("AdminLayout"),W=y("ConfirmDialog"),H=y("FullScreenLoading");return B(),L(j,null,[r($,null,{default:h(()=>[s("form",ne,[s("div",ue,[s("div",ie,[Y(s("input",{"onUpdate:modelValue":g[0]||(g[0]=N=>a.value=N),type:"text",class:"w-full h-10 pl-4 pr-12 border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-[#669ee9] focus:border-[#669ee9]",placeholder:"Search",onInput:p},null,544),[[Z,a.value]]),g[3]||(g[3]=s("span",{class:"absolute right-0 top-0 h-full px-3 flex items-center text-[#669ee9] border-l border-gray-200"},[s("i",{class:"bi bi-search"})],-1))])]),s("div",{class:"flex items-center justify-between gap-3.5"},[s("button",{type:"button",class:"flex items-center justify-center w-[159px] h-10 text-[#669ee9] bg-white border border-gray-200 rounded hover:bg-[#669ee9] hover:text-white transition-colors duration-150",onClick:l},g[4]||(g[4]=[s("i",{class:"bi bi-plus-lg"},null,-1),s("span",{class:"ml-2.5"},"Add New",-1)])),s("button",{onClick:S,type:"button",class:"flex items-center justify-center w-[47px] h-10 text-[#669ee9] bg-white border border-gray-200 rounded hover:bg-[#669ee9] hover:text-white transition-colors duration-150"},g[5]||(g[5]=[s("i",{class:"bi bi-arrow-repeat"},null,-1)]))])]),r(z,{configs:t.value,filters:e.value,"rows-per-page":10,onEdit:o,onDelete:U},null,8,["configs","filters"]),r(Q,{modelValue:f.value,"onUpdate:modelValue":g[1]||(g[1]=N=>f.value=N),size:"3xl",title:i.value?"Update User  ":"Create User",onClose:b},{default:h(()=>[i.value?(B(),G(O(re),{key:0,user:i.value,onSubmit:n},null,8,["user"])):(B(),G(O(oe),{key:1,onSubmit:n}))]),_:1},8,["modelValue","title"])]),_:1}),r(W,{modelValue:m.value,"onUpdate:modelValue":g[2]||(g[2]=N=>m.value=N),onAccept:F,onDeny:u},null,8,["modelValue"]),r(H,{open:c.value},null,8,["open"])],64)}}};export{ce as default};

import{_ as q,r as u,M as z,N as X,O as G,e as Y,c as V,k as a,l as v,F as J,E as c,t as Z,S as ee,P as le,j as C,o as S,a as l,D as r,z as te,b as p,x as oe,Q as se,u as ae,U as y}from"./index-3TT_0WAL.js";import{P as ne}from"./ProfileView-HUNno1_P.js";import{u as re}from"./room.store-CdDzEcyT.js";const ie={class:"w-full bg-gray-50"},ue={class:"mx-auto p-6 space-y-6"},de={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},ce={class:"lg:sticky lg:top-6 h-fit space-y-6"},pe={class:"bg-white rounded-2xl shadow-xl overflow-hidden"},me={class:"px-6 pb-6"},fe={class:"flex justify-center"},ve={class:"relative -mt-16 mb-4"},be=["src"],ge={key:0,class:"text-center text-sm text-blue-600 mb-4"},xe={class:"text-center mb-6"},ye={class:"text-2xl font-bold text-gray-800"},he={class:"text-gray-600"},_e={class:"bg-gray-50 rounded-xl p-4"},we={class:"flex items-center justify-between mb-2"},ke={class:"font-semibold text-gray-800"},Ve={class:"flex items-center justify-between"},Ce={class:"font-semibold text-blue-600"},Se={class:"flex items-center justify-between"},Ue={class:"font-semibold text-blue-600"},Ee={class:"flex items-center justify-between"},Ne={class:"font-semibold text-blue-600"},Pe={class:"flex items-center justify-between"},Me={class:"font-semibold text-blue-600"},je={class:"bg-white rounded-2xl shadow-xl p-8"},De={class:"flex items-center space-x-3"},Te={class:"flex items-center"},Re={class:"lg:col-span-2 space-y-6"},Ae={class:"bg-white rounded-2xl shadow-xl p-8"},Ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Be={class:"col-span-2"},Fe={class:"col-span-2"},Ie={class:"mt-6 flex justify-end"},Le={class:"bg-white rounded-2xl shadow-xl p-8"},Oe={class:"space-y-4"},He="https://i.pravatar.cc/150?img=3",Ke={__name:"EditProfileView",setup(Qe){const t=u({CoursesSignedUp:0,CoursesSuccessfullyCompleted:0,profile:{}}),N=u({full_name:"",coin:"",dob:"",email:"",avatar_url:"",status:"",role:"",code:"",created_at:"",updated_at:"",email_contact:"",gender:"",phone_contact:"",room:""}),n=u({...N.value}),h=z(),P=X(),B=re(),M=u(null),_=u(""),b=u(""),w=u(""),j=u(!0),d=u(!1),U=u(""),m=u(!1),D=u(""),T=u([]);async function F(o){const e=o.target.files[0],f=Math.floor(new Date().getTime()/1e3),g=`picture/${t.value.profile.avatar_url}/${f}`;if(await P.handleUploadVideo(e,g)){const k={...t.value,profile:{...t.value.profile,gender:Number(t.value.profile.gender),role:R(t.value.profile.role),avatar_url:g}},x=await h.handleEditProfile(k.profile);m.value=!1,x.errors?c({text:x.errors,type:"error"}):(c({text:"Update successfully",type:"success"}),E())}}const I=()=>{M.value.click()};function L(o){return{[y.ADMIN]:"ADMIN",[y.TEACHER]:"TEACHER",[y.STUDENT]:"STUDENT"}[o]||"UNKNOWN"}async function O(){m.value=!0;const o=await B.handleGetAllRoom();m.value=!1,o.errors?c({text:o.errors,type:"error"}):T.value=o.data.map(e=>({value:e._id,label:e.name}))}const H=Object.keys(G).map(o=>({value:G[o].toString(),label:o.charAt(0)+o.slice(1).toLowerCase()}));async function E(){m.value=!0;const o=Z(ee.accessToken),e=await h.handleGetProfile(o);m.value=!1,e.errors?c({text:e.errors,type:"error"}):(console.log(e.data.profile),t.value={...e.data,profile:{...e.data.profile,dob:le(e.data.profile.dob),role:L(e.data.profile.role)}},K(t.value.profile.avatar_url))}async function K(o){const e=await P.handleFetchVideo(o);e.error&&c({text:e.errors,type:"error"}),D.value=e.url}function R(o){if(o){const e=Object.keys(y).find(i=>i.toLowerCase()===o.toLowerCase());return e?y[e]:null}}async function Q(){let o=!0;if(n.value={...N.value},t.value.profile.full_name.trim()===""&&(n.value.full_name="Họ và tên không được để trống.",o=!1),t.value.profile.room.trim()===""&&(n.value.room="Họ và tên không được để trống.",o=!1),t.value.profile.dob||(n.value.dob="Ngày sinh không được để trống.",o=!1),o){m.value=!0;const e={...t.value,profile:{...t.value.profile,gender:Number(t.value.profile.gender),role:R(t.value.profile.role)}},i=await h.handleEditProfile(e.profile);m.value=!1,i.errors?c({text:i.errors,type:"error"}):(c({text:"Update successfully",type:"success"}),E(),d.value=!1)}}const W=()=>{d.value?(d.value=!1,U.value=""):d.value=!0};async function $(){if(b.value===w.value){const o={oldPassword:_.value,newPassword:b.value},e=await h.handleChangePassword(o);e.errors?c({text:e.errors,type:"error"}):(c({text:"Update successfully",type:"success"}),_.value="",b.value="",w.value="")}else c({text:"Mật khẩu mới và xác nhận mật khẩu không trùng nhau",type:"error"})}return Y(()=>{E(),O()}),(o,e)=>{const i=C("GenericInput"),f=C("SmallComponent"),g=C("GenericSelect"),A=C("FullScreenLoading");return S(),V(J,null,[a(ne,null,{default:v(()=>{var k,x;return[l("div",ie,[l("div",ue,[e[33]||(e[33]=l("div",{class:"text-center py-8"},[l("h1",{class:"text-4xl font-bold text-gray-800 mb-2"},"Hồ Sơ Cá Nhân"),l("p",{class:"text-gray-600"},"Quản lý thông tin cá nhân của bạn")],-1)),l("div",de,[l("div",ce,[l("div",pe,[e[16]||(e[16]=l("div",{class:"h-32 bg-gradient-to-r from-blue-500 to-purple-600"},null,-1)),l("div",me,[l("div",fe,[l("div",ve,[l("img",{src:D.value||He,alt:"Profile Picture",class:"w-32 h-32 rounded-full border-4 border-white shadow-lg object-cover"},null,8,be),l("button",{onClick:I,class:"absolute bottom-0 right-0 bg-blue-600 text-white p-2 rounded-full hover:bg-blue-700 transition-all duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},e[10]||(e[10]=[l("i",{class:"bi bi-camera-fill text-lg"},null,-1)]))])]),l("input",{type:"file",ref_key:"fileInput",ref:M,onChange:F,accept:"image/*",class:"hidden"},null,544),U.value?(S(),V("div",ge,r(U.value),1)):te("",!0),l("div",xe,[l("h2",ye,r((k=t.value.profile)==null?void 0:k.full_name),1),l("p",he,r((x=t.value.profile)==null?void 0:x.email),1)]),l("div",_e,[l("div",we,[e[11]||(e[11]=l("span",{class:"text-gray-600"},"Mã người dùng:",-1)),l("span",ke,r(t.value.profile.code),1)]),l("div",Ve,[e[12]||(e[12]=l("span",{class:"text-gray-600"},"Số coin:",-1)),l("span",Ce,r(t.value.profile.coin),1)]),l("div",Se,[e[13]||(e[13]=l("span",{class:"text-gray-600"},"Vai trò:",-1)),l("span",Ue,r(t.value.profile.role),1)]),l("div",Ee,[e[14]||(e[14]=l("span",{class:"text-gray-600"},"Khóa học tham gia:",-1)),l("span",Ne,r(t.value.CoursesSignedUp),1)]),l("div",Pe,[e[15]||(e[15]=l("span",{class:"text-gray-600"},"Khóa học hoàn thành:",-1)),l("span",Me,r(t.value.CoursesSuccessfullyCompleted),1)])])])]),l("div",je,[e[18]||(e[18]=l("h2",{class:"text-2xl font-bold text-gray-800 mb-6 flex items-center"},[l("i",{class:"bi bi-bell-fill mr-2 text-blue-600"}),p(" Cài đặt thông báo ")],-1)),l("div",De,[l("div",Te,[oe(l("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=s=>j.value=s),class:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},null,512),[[se,j.value]]),e[17]||(e[17]=l("label",{class:"ml-2 text-gray-700"},"Nhận thông báo qua email",-1))])])])]),l("div",Re,[l("div",Ae,[e[27]||(e[27]=l("h2",{class:"text-2xl font-bold text-gray-800 mb-6 flex items-center"},[l("i",{class:"bi bi-person-fill mr-2 text-blue-600"}),p(" Thông tin cá nhân ")],-1)),l("div",Ge,[l("div",Be,[e[19]||(e[19]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Họ và tên",-1)),a(i,{modelValue:t.value.profile.full_name,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.profile.full_name=s),type:"text",disabled:!d.value,error:!!n.value.full_name},null,8,["modelValue","disabled","error"]),a(f,null,{default:v(()=>[p(r(n.value.full_name),1)]),_:1})]),l("div",Fe,[e[20]||(e[20]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phòng ban",-1)),a(g,{options:T.value,placeholder:"Chọn giới tính",modelValue:t.value.profile.room,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.profile.room=s),disabled:!d.value,error:!!n.value.room},null,8,["options","modelValue","disabled","error"]),a(f,null,{default:v(()=>[p(r(n.value.room),1)]),_:1})]),l("div",null,[e[21]||(e[21]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ngày sinh",-1)),a(i,{modelValue:t.value.profile.dob,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.profile.dob=s),type:"date",disabled:!d.value,error:!!n.value.dob},null,8,["modelValue","disabled","error"]),a(f,null,{default:v(()=>[p(r(n.value.dob),1)]),_:1})]),l("div",null,[e[22]||(e[22]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email liên hệ",-1)),a(i,{modelValue:t.value.profile.email_contact,"onUpdate:modelValue":e[4]||(e[4]=s=>t.value.profile.email_contact=s),type:"email",disabled:!d.value,error:!!n.value.email_contact},null,8,["modelValue","disabled","error"]),a(f,null,{default:v(()=>[p(r(n.value.email_contact),1)]),_:1})]),l("div",null,[e[23]||(e[23]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Số điện thoại",-1)),a(i,{modelValue:t.value.profile.phone_contact,"onUpdate:modelValue":e[5]||(e[5]=s=>t.value.profile.phone_contact=s),type:"email",disabled:!d.value,error:!!n.value.phone_contact},null,8,["modelValue","disabled","error"]),a(f,null,{default:v(()=>[p(r(n.value.phone_contact),1)]),_:1})]),l("div",null,[e[24]||(e[24]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Giới tính",-1)),a(g,{options:ae(H),placeholder:"Chọn giới tính",modelValue:t.value.profile.gender,"onUpdate:modelValue":e[6]||(e[6]=s=>t.value.profile.gender=s),disabled:!d.value,error:!!n.value.gender},null,8,["options","modelValue","disabled","error"]),a(f,null,{default:v(()=>[p(r(n.value.gender),1)]),_:1})])]),l("div",Ie,[d.value?(S(),V("button",{key:1,onClick:Q,class:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-all duration-300 flex items-center"},e[26]||(e[26]=[l("i",{class:"bi bi-check2"},null,-1),l("span",{class:"ml-2"},"Lưu thay đổi",-1)]))):(S(),V("button",{key:0,onClick:W,class:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-300 flex items-center"},e[25]||(e[25]=[l("i",{class:"bi bi-pencil-fill"},null,-1),l("span",{class:"ml-2"},"Sửa thông tin",-1)])))])]),l("div",Le,[e[32]||(e[32]=l("h2",{class:"text-2xl font-bold text-gray-800 mb-6 flex items-center"},[l("i",{class:"bi bi-shield-lock-fill mr-2 text-blue-600"}),p(" Đổi mật khẩu ")],-1)),l("div",Oe,[l("div",null,[e[28]||(e[28]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mật khẩu hiện tại",-1)),a(i,{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=s=>_.value=s),type:"password"},null,8,["modelValue"])]),l("div",null,[e[29]||(e[29]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mật khẩu mới",-1)),a(i,{modelValue:b.value,"onUpdate:modelValue":e[8]||(e[8]=s=>b.value=s),type:"password"},null,8,["modelValue"])]),l("div",null,[e[30]||(e[30]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Xác nhận mật khẩu mới",-1)),a(i,{modelValue:w.value,"onUpdate:modelValue":e[9]||(e[9]=s=>w.value=s),type:"password"},null,8,["modelValue"])])]),l("div",{class:"mt-6 flex justify-end"},[l("button",{onClick:$,class:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-300 flex items-center"},e[31]||(e[31]=[l("i",{class:"bi bi-key-fill mr-2"},null,-1),p(" Cập nhật mật khẩu ")]))])])])])])])]}),_:1}),a(A,{open:m.value},null,8,["open"])],64)}}},ze=q(Ke,[["__scopeId","data-v-2717b3ba"]]);export{ze as default};

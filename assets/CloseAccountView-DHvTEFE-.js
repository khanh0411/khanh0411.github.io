import{_ as N,M as _,r as p,T as f,e as L,s as M,l as B,t as P,S as U,E as z,o as a,a as e,c as i,V as A,x as y,W as g,b as u,X as R,R as k,F as v,q as X,D as r,z as c,C as j}from"./index-Cyg9ldsc.js";import{P as q}from"./ProfileView-zjYKQOZF.js";const F={class:"container mx-auto px-4 py-8"},G={class:"max-w-2xl mx-auto bg-white shadow-lg rounded-xl p-6"},H={class:"flex space-x-4"},O={class:"flex items-center"},Y={class:"flex items-center"},I=["value"],Q={key:0,class:"text-red-500 text-sm mt-1"},W={key:0,class:"text-red-500 text-sm mt-1"},$={class:"bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6"},J={class:"space-y-3"},Z={key:0},ee={key:0,class:"bg-blue-50 p-4 rounded-md mb-6"},te={class:"text-blue-800 text-center"},le={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},se={class:"bg-white rounded-xl p-6 max-w-md w-full"},oe={class:"text-gray-600 text-center mb-6"},ne={class:"flex space-x-4"},ae={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ie={__name:"CloseAccountView",setup(re){const w=_(),h=p(!1),x=p({}),s=f({type:"",reason:"",lockDate:"",unlockDate:""});async function T(){m.value=!0;const d=P(U.accessToken),t=await w.handleGetProfile(d);m.value=!1,t.errors?z({text:t.errors,type:"error"}):(x.value=t.data.profile,console.log(x.value))}const l=f({closeType:"temporary",reason:"",confirmEmail:""}),o=f({email:"",reason:""}),b=p(!1),m=p(!1),K=p(["Không còn nhu cầu sử dụng","Chuyển công ty","Không phù hợp với nhu cầu","Lý do khác"]),V=()=>{let d=!0;return o.email="",o.reason="",l.reason||(o.reason="Vui lòng chọn lý do khóa tài khoản",d=!1),l.confirmEmail?l.confirmEmail!==x.value.email&&(o.email="Email không khớp với tài khoản",d=!1):(o.email="Vui lòng nhập email xác nhận",d=!1),d},D=()=>{V()&&(b.value=!0)},C=()=>{m.value=!0,setTimeout(()=>{h.value=!0,s.type=l.closeType,s.reason=l.reason,s.lockDate=new Date().toLocaleDateString("vi-VN"),s.unlockDate=l.closeType==="temporary"?new Date(Date.now()+30*24*60*60*1e3).toLocaleDateString("vi-VN"):"Vĩnh viễn",b.value=!1,m.value=!1},1e3)},E=()=>{h.value=!1,Object.assign(l,{closeType:"temporary",reason:"",confirmEmail:""})};return L(()=>{T()}),(d,t)=>(a(),M(q,null,{default:B(()=>[e("div",F,[e("div",G,[h.value?(a(),i(v,{key:1},[t[17]||(t[17]=e("div",{class:"text-center mb-6"},[e("i",{class:"bi bi-lock-fill text-gray-500 text-5xl mb-4"}),e("h2",{class:"text-2xl font-bold text-gray-800 mb-4"},"Tài Khoản Đã Bị Khóa")],-1)),e("div",$,[e("div",J,[e("p",null,[t[13]||(t[13]=e("strong",null,"Loại khóa:",-1)),u(" "+r(s.type==="temporary"?"Tạm thời":"Vĩnh viễn"),1)]),e("p",null,[t[14]||(t[14]=e("strong",null,"Lý do:",-1)),u(" "+r(s.reason),1)]),e("p",null,[t[15]||(t[15]=e("strong",null,"Ngày khóa:",-1)),u(" "+r(s.lockDate),1)]),s.type==="temporary"?(a(),i("p",Z,[t[16]||(t[16]=e("strong",null,"Ngày mở khóa dự kiến:",-1)),u(" "+r(s.unlockDate),1)])):c("",!0)])]),s.type==="temporary"?(a(),i("div",ee,[e("p",te," Tài khoản của bạn sẽ tự động được mở khóa vào ngày "+r(s.unlockDate),1)])):c("",!0),e("button",{onClick:E,class:"w-full bg-gray-500 text-white py-3 rounded-md hover:bg-gray-600 transition"}," Yêu Cầu Mở Khóa Sớm ")],64)):(a(),i(v,{key:0},[t[12]||(t[12]=e("div",{class:"text-center mb-6"},[e("i",{class:"bi bi-lock-fill text-red-500 text-5xl mb-4"}),e("h2",{class:"text-2xl font-bold text-gray-800 mb-4"},"Khóa Tài Khoản"),e("div",{class:"bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-6"},[e("div",{class:"flex items-start"},[e("i",{class:"bi bi-exclamation-circle-fill text-yellow-600 mr-3 mt-1"}),e("div",{class:"text-left text-yellow-700"},[e("p",{class:"font-semibold"},"Cảnh Báo: Hậu Quả Khóa Tài Khoản"),e("ul",{class:"list-disc list-inside text-sm mt-2"},[e("li",null,"Mất quyền truy cập vào tất cả khóa học"),e("li",null,"Dữ liệu học tập sẽ bị xóa sau 30 ngày"),e("li",null,"Không thể phục hồi thông tin sau khi xóa vĩnh viễn")])])])])],-1)),e("form",{onSubmit:A(D,["prevent"]),class:"space-y-6"},[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Hình Thức Khóa Tài Khoản",-1)),e("div",H,[e("label",O,[y(e("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=n=>l.closeType=n),value:"temporary",class:"mr-2"},null,512),[[g,l.closeType]]),t[5]||(t[5]=u(" Khóa Tạm Thời "))]),e("label",Y,[y(e("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=n=>l.closeType=n),value:"permanent",class:"mr-2"},null,512),[[g,l.closeType]]),t[6]||(t[6]=u(" Khóa Vĩnh Viễn "))])])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Lý Do Khóa Tài Khoản",-1)),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>l.reason=n),class:k(["w-full px-3 py-2 border rounded-md",{"border-red-500":o.reason}])},[t[8]||(t[8]=e("option",{value:""},"Chọn lý do",-1)),(a(!0),i(v,null,X(K.value,(n,S)=>(a(),i("option",{key:S,value:n},r(n),9,I))),128))],2),[[R,l.reason]]),o.reason?(a(),i("p",Q,r(o.reason),1)):c("",!0)]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Xác Nhận Email",-1)),y(e("input",{type:"email","onUpdate:modelValue":t[3]||(t[3]=n=>l.confirmEmail=n),placeholder:"Nhập email để xác nhận",class:k(["w-full px-3 py-2 border rounded-md",{"border-red-500":o.email}])},null,2),[[j,l.confirmEmail]]),o.email?(a(),i("p",W,r(o.email),1)):c("",!0)]),t[11]||(t[11]=e("button",{type:"submit",class:"w-full bg-red-500 text-white py-3 rounded-md hover:bg-red-600 transition"}," Yêu Cầu Khóa Tài Khoản ",-1))],32)],64)),b.value?(a(),i("div",le,[e("div",se,[t[18]||(t[18]=e("h3",{class:"text-xl font-bold mb-4 text-center"},"Xác Nhận Khóa Tài Khoản",-1)),e("p",oe," Bạn có chắc chắn muốn "+r(l.closeType==="temporary"?"khóa tạm thời":"khóa vĩnh viễn")+" tài khoản không? ",1),e("div",ne,[e("button",{onClick:t[4]||(t[4]=n=>b.value=!1),class:"flex-1 border border-gray-300 py-2 rounded-md hover:bg-gray-100"}," Hủy "),e("button",{onClick:C,class:"flex-1 bg-red-500 text-white py-2 rounded-md hover:bg-red-600"}," Xác Nhận ")])])])):c("",!0),m.value?(a(),i("div",ae,t[19]||(t[19]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"},null,-1)]))):c("",!0)])])]),_:1}))}},ce=N(ie,[["__scopeId","data-v-b95044ea"]]);export{ce as default};

import{t as A,S as L,v as V,r as u,i as _,e as G,s as j,l as B,E as n,o as p,a as e,D as a,x as k,C,u as S,c as y,z as D,q as E,R as f,F as q}from"./index-MMv_fUx2.js";import{P as H}from"./ProfileView-B2aUu2-X.js";import{u as M}from"./studentCourse.store-Gh1PMHZm.js";const Y={class:"max-w-4xl mx-auto p-6"},z={class:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-2xl shadow-xl mb-8"},F={class:"p-8"},U={class:"flex items-baseline"},W={class:"text-4xl font-bold text-white"},$={class:"flex justify-center items-center gap-6 mb-8"},I={class:"bg-white rounded-xl shadow-md p-6 w-full"},K={key:0,class:"bg-white rounded-xl shadow-md p-6 w-full"},O=["max"],J={class:"bg-white rounded-xl shadow-md"},Q={class:"overflow-x-auto"},X={class:"w-full"},Z={class:"divide-y divide-gray-100"},ee={class:"px-6 py-4"},te={class:"flex items-center"},se={class:"ml-2"},le={class:"px-6 py-4 text-gray-600"},oe={class:"px-6 py-4"},ne={class:"flex items-center justify-between p-4"},ae=["disabled"],re=["disabled"],pe={__name:"PaymentInformationView",setup(ie){const x=M(),N=A(L.accessToken),h=V(N),c=u(0),r=u(0),o=u(0),d=u(!1),v=u([]),g=u(5),i=u(1),b=_(()=>Math.ceil(v.value.length/g.value)),T=_(()=>{const s=(i.value-1)*g.value,t=s+g.value;return v.value.slice(s,t)}),w=s=>{s>0&&s<=b.value&&(i.value=s)};async function P(){if(r.value===0&&n({text:"Hãy nhập số coins bạn muốn nạp",type:"warn"}),r.value<0&&n({text:"Số coins bạn muốn nạp không thể nhỏ hơn 0",type:"warn"}),r.value>0){d.value=!0;const s=r.value;d.value=!1;const t=await x.handleRechargeAccount(s);t.errors?n({text:t.errors,type:"error"}):(r.value=0,n({text:"Gửi yêu cầu nạp tiền thành công",type:"success"}),m())}}async function m(){d.value=!0;const s=await x.handleGetRechargeHistory();d.value=!1,s.errors?n({text:s.errors,type:"error"}):(console.log(s),v.value=s.purchase_history,c.value=s.coin)}async function R(){if((o.value===0||o.value<0)&&n({text:"Hãy nhập số coins bạn muốn nạp",type:"warn"}),o.value>=c.value&&o.value>0&&n({text:"Số dư không đủ",type:"warn"}),o.value>0&&o.value<=c.value){d.value=!0;const s=await x.handleWithdrawalAccount(o.value);d.value=!1,s.errors?n({text:s.errors,type:"error"}):(o.value=0,n({text:"Gửi yêu cầu rút tiền thành công",type:"success"}),m())}}return G(()=>{m()}),(s,t)=>(p(),j(H,null,{default:B(()=>[e("div",Y,[e("div",z,[e("div",F,[t[5]||(t[5]=e("div",{class:"text-white/80 mb-2"},"Số dư hiện tại",-1)),e("div",U,[e("span",W,a(c.value.toLocaleString()),1),t[4]||(t[4]=e("span",{class:"text-white/80 ml-2"},"coins",-1))])])]),e("div",$,[e("div",I,[t[6]||(t[6]=e("div",{class:"flex items-center mb-4"},[e("i",{class:"bi bi-plus-circle text-green-500 text-xl"}),e("h3",{class:"ml-2 font-semibold"},"Nạp Coins")],-1)),k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>r.value=l),type:"number",class:"w-full px-4 py-3 rounded-lg border border-gray-200 mb-4 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập số coins muốn nạp",min:"1"},null,512),[[C,r.value]]),e("button",{onClick:P,class:"w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg transition-colors"}," Yêu cầu nạp ")]),S(h).user.role===1||S(h).user.role===2?(p(),y("div",K,[t[7]||(t[7]=e("div",{class:"flex items-center mb-4"},[e("i",{class:"bi bi-dash-circle text-red-500 text-xl"}),e("h3",{class:"ml-2 font-semibold"},"Rút Coins")],-1)),k(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.value=l),type:"number",class:"w-full px-4 py-3 rounded-lg border border-gray-200 mb-4 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập số coins muốn rút",max:c.value,min:"1"},null,8,O),[[C,o.value]]),e("button",{onClick:R,class:"w-full bg-red-500 hover:bg-red-600 text-white py-3 rounded-lg transition-colors"}," Yêu cầu rút ")])):D("",!0)]),e("div",J,[t[9]||(t[9]=e("div",{class:"p-6 border-b"},[e("div",{class:"flex items-center justify-between"},[e("h2",{class:"text-xl font-semibold"},"Lịch sử giao dịch"),e("i",{class:"bi bi-clock-history text-gray-500"})])],-1)),e("div",Q,[e("table",X,[t[8]||(t[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-sm font-semibold text-gray-600"},"Loại"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold text-gray-600"},"Số lượng"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold text-gray-600"},"Ngày"),e("th",{class:"px-6 py-4 text-left text-sm font-semibold text-gray-600"},"Trạng thái")])],-1)),e("tbody",Z,[(p(!0),y(q,null,E(T.value,l=>(p(),y("tr",{key:l.id,class:"hover:bg-gray-50"},[e("td",ee,[e("div",te,[e("i",{class:f(["bi",l.type2==="Nạp"?"bi-plus-circle text-green-500":"bi-dash-circle text-red-500"])},null,2),e("span",se,a(l.type),1)])]),e("td",{class:f(["px-6 py-4 font-medium",l.type2==="Nạp"?"text-green-500":"text-red-500"])},a(l.type2==="Nạp"?"+":"-")+a(l.coins.toLocaleString()),3),e("td",le,a(l.date),1),e("td",oe,[e("span",{class:f(["px-2 py-1 rounded-full text-sm",l.statuscoins==="pending"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"])},a(l.statuscoins),3)])]))),128))])])]),e("div",ne,[e("button",{onClick:t[2]||(t[2]=l=>w(i.value-1)),disabled:i.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50"}," Trước ",8,ae),e("span",null,"Trang "+a(i.value)+" / "+a(b.value),1),e("button",{onClick:t[3]||(t[3]=l=>w(i.value+1)),disabled:i.value===b.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50"}," Tiếp ",8,re)])])])]),_:1}))}};export{pe as default};

import{K as p,r as d,L as n,cg as h,S as m,Z as l,M as o,cj as f}from"./index-Cww7t7_x.js";function y(t){return String(t).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}function S(t){return String(t).toLowerCase().match(/^(?:(?=.*[a-z])(?:(?=.*[A-Z])(?=.*[\d\W])|(?=.*\W)(?=.*\d))|(?=.*\W)(?=.*[A-Z])(?=.*\d)).{8,}$/)}const A=p("auth",()=>{const t=d(null);async function i(r){var s;try{const e=await n.post("/api/auth/login",r);h(m.accessToken,e.data.token,7);const a=l(e.data.token);return t.value=a.user,{user:a.user}}catch(e){return e instanceof o?{errors:((s=e.response.data)==null?void 0:s.message)||[]}:{errors:["Something wrong, please try later"]}}}async function c(r){var s;try{return await n.post("/api/auth/register",r)}catch(e){return e instanceof o?{errors:((s=e.response.data)==null?void 0:s.message)||[]}:{errors:["Something wrong, please try later"]}}}async function u(r){var s;try{return await f.post("/api/auth/forgotPassword",{email:r})}catch(e){return e instanceof o?{errors:((s=e.response.data)==null?void 0:s.message)||[]}:{errors:["Something wrong, please try later"]}}}async function g(r){var s;try{return await n.post("/api/auth/resetPassword",{newPassword:r})}catch(e){return e instanceof o?{errors:((s=e.response.data)==null?void 0:s.message)||[]}:{errors:["Something wrong, please try later"]}}}return{user:t,handleLogin:i,handleCreateUser:c,handleForgetPassWord:u,handleResetPassWord:g}});export{S as a,y as i,A as u};

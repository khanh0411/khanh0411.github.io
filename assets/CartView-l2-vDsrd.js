import{_ as $,G as I,r as f,i as x,e as L,o as r,c as i,a as t,D as n,F as b,q as V,z as y,L as P,E as m,w as j,s as E,l as M,j as R,k as B,b as F}from"./index-Cyg9ldsc.js";const N={key:0,class:"item flex w-auto border-t border-gray-200 py-6"},O=["src"],D={class:"ml-6 flex-grow"},G={class:"relative group w-64"},q={class:"font-bold text-base leading-5 mt-2 max-w-full truncate"},z={class:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-max bg-gray-800 text-white text-sm rounded-md px-4 py-2 opacity-0 transition-opacity duration-300 group-hover:opacity-100 z-10 shadow-lg"},T={class:"font-normal text-sm mt-1 truncate"},A={class:"flex items-center mt-1"},J={key:0,class:"bi bi-star-fill text-yellow-500"},K={key:1,class:"bi bi-star-half text-yellow-500"},U={key:2,class:"bi bi-star text-gray-300"},Y={class:"ml-2 text-sm text-gray-600"},H={class:"text-sm flex items-center text-gray-500 mt-1"},Q={class:"flex items-center gap-5 mt-2"},W={class:"text-lg flex gap-2 mt-1 flex-col ml-20"},X={class:"font-bold"},Z={class:"font-normal text-gray-500 line-through"},tt={__name:"ItemCard",props:{item:{type:Object,require:!0},rating:{type:Number,default:4.5}},emits:["remove"],setup(w,{emit:_}){const d=_,c=I(),v=f(!0),u=f(),o=w,p=e=>{for(const[l,a]of Object.entries(P))if(a===e)return l;return"unknown"},g=x(()=>[1,2,3,4,5].map(e=>e<=Math.floor(o.rating)?"full":e-1<o.rating&&o.rating%1!==0?"half":"empty"));async function s(e){console.log(e);const l=e._id,a=await c.handleremoveFromCart(l);a.errors?m({text:a.errors,type:"error"}):d("remove",e.name)}return L(()=>{u.value=p(o.item.level)}),(e,l)=>v.value?(r(),i("div",N,[t("img",{src:o.item.image,class:"w-52 h-32 object-cover"},null,8,O),t("div",D,[t("div",G,[t("div",q,n(o.item.name),1),t("div",z,n(o.item.name),1)]),t("p",T,n(o.item.author),1),t("div",A,[(r(!0),i(b,null,V(g.value,(a,h)=>(r(),i(b,{key:h},[a==="full"?(r(),i("i",J)):a==="half"?(r(),i("i",K)):(r(),i("i",U))],64))),128)),t("span",Y,"("+n(o.rating)+")",1)]),t("div",H,[t("span",null,n(u.value),1)]),t("div",Q,[t("button",{class:"text-violet-600 hover:font-semibold transition-all duration-200",onClick:l[0]||(l[0]=a=>s(o.item))}," Remove ")])]),t("div",W,[t("div",X,n(o.item.coursePrice)+" Coins",1),t("div",Z,n(o.item.originalPrice)+" Coins",1)])])):y("",!0)}},et=$(tt,[["__scopeId","data-v-843107dd"]]),st={class:"min-h-screen bg-gray-50"},ot={class:"container mx-auto px-4 py-8"},at={class:"flex flex-col-reverse lg:flex-row gap-8"},rt={class:"flex-1"},lt={key:0,class:"text-center py-8 text-gray-500"},nt={key:0,class:"lg:w-80 mb-8 lg:mb-0"},it={class:"bg-white rounded-lg shadow-sm p-6 sticky top-4"},ct={class:"mb-6"},dt={class:"text-3xl font-bold mb-2"},ut={class:"text-gray-500 line-through mb-1"},mt={class:"text-green-600 font-semibold"},_t=["disabled"],vt={__name:"CartView",setup(w){const _=I(),d=f(0);j(d,(s,e)=>{console.log(`Total đã thay đổi từ ${e} thành ${s}`)});const c=f([]);async function v(){const s=await _.handleGetAllCart();s.errors?m({text:s.errors,type:"error"}):(d.value=s.data.totalPrice,c.value=s.data.items.map(e=>{const{course_id:l,...a}=e;return{...a,...l,_id:e._id}}))}const u=x(()=>c.value.reduce((s,e)=>s+parseFloat(e.originalPrice||0),0)),o=x(()=>Math.floor(d.value/u.value*100));function p(s){c.value.splice(s,1),m({text:`Item at index ${s} removed.`,type:"success"})}async function g(){const s=await _.handleJoinCoursesInCart();s.errors?m({text:s.errors,type:"error"}):(m({text:"Check out successfully",type:"success"}),v())}return L(()=>{v()}),(s,e)=>{const l=R("MainLayout");return r(),E(l,null,{default:M(()=>{var a,h,C;return[t("div",st,[t("div",ot,[e[3]||(e[3]=t("h1",{class:"cart-title font-bold mb-12"},"Shopping Cart",-1)),t("div",at,[t("div",rt,[(r(!0),i(b,null,V(c.value,(k,S)=>(r(),i("div",{key:k.id,class:"mb-4"},[B(et,{item:k,onRemove:ht=>p(S,s.cd)},null,8,["item","onRemove"])]))),128)),((a=c.value)==null?void 0:a.length)===0?(r(),i("div",lt,e[0]||(e[0]=[t("i",{class:"bi bi-cart text-4xl mb-4"},null,-1),t("p",null,"Your cart is empty",-1)]))):y("",!0)]),((h=c.value)==null?void 0:h.length)!==0?(r(),i("div",nt,[t("div",it,[t("div",ct,[e[1]||(e[1]=t("div",{class:"text-gray-600 font-bold mb-2"},"Total:",-1)),t("div",dt,"₫"+n(d.value),1),t("div",ut,"₫"+n(u.value.toLocaleString()),1),t("div",mt,n(o.value)+"% off",1)]),t("button",{onClick:g,class:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:((C=c.value)==null?void 0:C.length)===0},e[2]||(e[2]=[t("i",{class:"bi bi-credit-card"},null,-1),F(" Checkout ")]),8,_t)])])):y("",!0)])])])]}),_:1})}}},pt=$(vt,[["__scopeId","data-v-99c64283"]]);export{pt as default};
